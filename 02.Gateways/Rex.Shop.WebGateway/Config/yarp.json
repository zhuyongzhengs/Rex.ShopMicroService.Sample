{
  "ReverseProxy": {
    "Routes": {
      "BaseService": {
        "ClusterId": "BaseServiceCluster",
        "Match": {
          "Path": "/api/base/{**everything}"
        }
      },
      //"AbpCatchAllService": {
      //  "ClusterId": "BaseServiceCluster",
      //  "Match": {
      //    "Path": "/api/abp/{**catch-all}"
      //  }
      //},
      "RexShopLocalization": {
        "ClusterId": "BaseServiceCluster",
        "Match": {
          "Path": "/api/abp/application-localization"
        }
      },
      "RexShopApplicationConfiguration": {
        "ClusterId": "BaseServiceCluster",
        "Match": {
          "Path": "/api/abp/application-configuration"
        }
      },
      "FeatureManagement": {
        "ClusterId": "BaseServiceCluster",
        "Match": {
          "Path": "/api/feature-management/{**everything}"
        }
      },
      "SettingManagement": {
        "ClusterId": "BaseServiceCluster",
        "Match": {
          "Path": "/api/setting-management/{**everything}"
        }
      },
      "PermissionManagement": {
        "ClusterId": "AuthServiceCluster",
        "Match": {
          "Path": "/api/permission-management/{**everything}"
        }
      },
      "AccountService": {
        "ClusterId": "AuthServiceCluster",
        "Match": {
          "Path": "/api/account/{**everything}"
        }
      },
      "AuthService": {
        "ClusterId": "AuthServiceCluster",
        "Match": {
          "Path": "/api/identity/{**everything}"
        }
      },
      "AuthorizationWebService": {
        "ClusterId": "AuthServiceCluster",
        "Match": {
          "Path": "/connect/{**everything}"
        }
      },
      "GoodService": {
        "ClusterId": "GoodServiceCluster",
        "Match": {
          "Path": "/api/good/{**everything}"
        }
      },
      "PromotionService": {
        "ClusterId": "PromotionServiceCluster",
        "Match": {
          "Path": "/api/promotion/{**everything}"
        }
      },
      "OrderService": {
        "ClusterId": "OrderServiceCluster",
        "Match": {
          "Path": "/api/order/{**everything}"
        }
      },
      "PaymentService": {
        "ClusterId": "PaymentServiceCluster",
        "Match": {
          "Path": "/api/payment/{**everything}"
        }
      },
      "BackendAggregationService": {
        "ClusterId": "BackendAggregationServiceCluster",
        "Match": {
          "Path": "/api/backend/aggregation/{**everything}"
        }
      }
    },
    "Clusters": {
      "BaseServiceCluster": {
        //"LoadBalancingPolicy": "PowerOfTwoChoices",
        /*
        【负载均衡策略】 First：选择第一个目标，不考虑负载。这对于双目标故障转移系统非常有用。
        Random：随机选择一个目标。 PowerOfTwoChoices
        (默认)：选择两个随机的目标，然后从中选择一个更少请求的目标。这避免了 LeastRequests
        的开销，也避免了 Random
        选择繁忙目的地的最坏情况。 RoundRobin：通过顺序循环选择一个目标。
        LeastRequests：所有目标中选择分配请求最少的目标。这需要检查所有目标。
        */
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:4455"
          }
          //"destination2": {
          //  "Address": "http://localhost:5000"
          //}
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:03",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/HealthCheck"
          },
          "Passive": {
            "Enabled": true,
            "Policy": "TransportFailureRate",
            "ReactivationPeriod": "00:00:30",
            "Options": {
              "FailureRateLimit": 0.05, // 5% 的请求失败率认为不健康
              "MinimumRequestCount": 5 // 至少 5 次请求后开始评估
            }
          }
        }
      },
      "AuthServiceCluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:4466"
          }
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:03",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/HealthCheck"
          },
          "Passive": {
            "Enabled": true,
            "Policy": "TransportFailureRate",
            "ReactivationPeriod": "00:00:30",
            "Options": {
              "FailureRateLimit": 0.05, // 5% 的请求失败率认为不健康
              "MinimumRequestCount": 5 // 至少 5 次请求后开始评估
            }
          }
        }
      },
      "GoodServiceCluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:4477"
          }
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:03",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/HealthCheck"
          },
          "Passive": {
            "Enabled": true,
            "Policy": "TransportFailureRate",
            "ReactivationPeriod": "00:00:30",
            "Options": {
              "FailureRateLimit": 0.05, // 5% 的请求失败率认为不健康
              "MinimumRequestCount": 5 // 至少 5 次请求后开始评估
            }
          }
        }
      },
      "PromotionServiceCluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:4488"
          }
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:03",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/HealthCheck"
          },
          "Passive": {
            "Enabled": true,
            "Policy": "TransportFailureRate",
            "ReactivationPeriod": "00:00:30",
            "Options": {
              "FailureRateLimit": 0.05, // 5% 的请求失败率认为不健康
              "MinimumRequestCount": 5 // 至少 5 次请求后开始评估
            }
          }
        }
      },
      "OrderServiceCluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:5500"
          }
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:03",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/HealthCheck"
          },
          "Passive": {
            "Enabled": true,
            "Policy": "TransportFailureRate",
            "ReactivationPeriod": "00:00:30",
            "Options": {
              "FailureRateLimit": 0.05, // 5% 的请求失败率认为不健康
              "MinimumRequestCount": 5 // 至少 5 次请求后开始评估
            }
          }
        }
      },
      "PaymentServiceCluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:5510"
          }
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:03",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/HealthCheck"
          },
          "Passive": {
            "Enabled": true,
            "Policy": "TransportFailureRate",
            "ReactivationPeriod": "00:00:30",
            "Options": {
              "FailureRateLimit": 0.05, // 5% 的请求失败率认为不健康
              "MinimumRequestCount": 5 // 至少 5 次请求后开始评估
            }
          }
        }
      },
      "BackendAggregationServiceCluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://localhost:4410"
          }
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:03",
            "Timeout": "00:00:05",
            "Policy": "ConsecutiveFailures",
            "Path": "/HealthCheck"
          },
          "Passive": {
            "Enabled": true,
            "Policy": "TransportFailureRate",
            "ReactivationPeriod": "00:00:30",
            "Options": {
              "FailureRateLimit": 0.05, // 5% 的请求失败率认为不健康
              "MinimumRequestCount": 5 // 至少 5 次请求后开始评估
            }
          }
        }
      }
    }
  }
}